# Stocks ESG

## Introduction

This project is designed to fetch, analyze, and organize a wide range of financial and sustainability data for publicly traded companies. It automates the process of gathering historical prices, financial statements, ESG (Environmental, Social, Governance) scores, peer comparisons, and more, saving all results in a well-structured Excel workbook for further analysis.

---

## Excel Output Sheets Explained

Each Excel file generated by Stock Analyzer contains multiple sheets, each dedicated to a specific aspect of the company's financial and ESG profile:

- **Historical Data**: Contains 5 years of daily stock price data (Open, High, Low, Close, Volume) for the selected ticker, allowing for trend and volatility analysis.
- **ESG Scores**: Presents Environmental, Social, and Governance (ESG) scores, including overall ESG rating and component breakdowns, to assess the company's sustainability and ethical impact.
- **Company Summary**: Provides a comprehensive overview of the company, including business summary, sector, industry, employee count, fiscal year end, and key facts.
- **Statistics**: Lists key financial ratios and metrics such as market cap, P/E ratio, dividend yield, profit margins, and more, organized by category for quick reference.
- **Sustainability**: Details additional sustainability information, such as controversy level and product involvement areas, highlighting the company's exposure to various ESG-related issues.
- **Peers**: Compares the target company with its industry peers, showing ESG risk scores and component scores for each peer, enabling benchmarking and relative analysis.
- **Income Statement**: Displays the company's annual income statement, including revenue, expenses, and net income, to evaluate profitability and operational performance.
- **Balance Sheet**: Shows the company's annual balance sheet, detailing assets, liabilities, and equity, providing insight into financial stability and structure.
- **Cash Flow**: Contains the company's annual cash flow statement, breaking down cash flows from operating, investing, and financing activities, essential for liquidity analysis.

---

## Key Concepts and Technologies Used

- **Python 3**: Core programming language.
- **yfinance**: For accessing Yahoo Finance data programmatically.
- **pandas**: Data manipulation and Excel export.
- **requests**: HTTP requests for web scraping and API calls.
- **BeautifulSoup & lxml**: HTML parsing for web scraping.
- **tqdm**: Progress bars for long-running operations.
- **xlsxwriter**: Advanced Excel formatting and writing.
- **python-dateutil**: Date and time utilities.

---

## Detailed Explanation of Each Component

### `StockAnalyzer` Class
The main agent of the system, responsible for orchestrating all data fetching and export operations for a given ticker.

#### Major Methods:
- **`fetch_all_data()`**: Main entry point; coordinates the fetching of all data types and writes them to Excel (all sheets).
- **`fetch_historical_data()`**: Retrieves 5-year historical price data and generates the **Historical Data** sheet.
- **`fetch_esg_data()`**: Fetches ESG scores and generates the **ESG Scores** sheet.
- **`fetch_company_summary()`**: Gathers company profile, business summary, and key facts, generating the **Company Summary** sheet.
- **`fetch_statistics()`**: Collects key financial statistics and ratios, generating the **Statistics** sheet.
- **`fetch_financials()`**: Extracts income statement, balance sheet, and cash flow data, generating the **Income Statement**, **Balance Sheet**, and **Cash Flow** sheets.
- **`fetch_sustainability()`**: Retrieves sustainability and product involvement data, generating the **Sustainability** sheet.
- **`fetch_peers_esg()`**: Gathers ESG and financial data for peer companies, generating the **Peers** sheet.

#### Supporting Methods:
- **Web Scraping Utilities**: For extracting data not available via APIs.
- **Fallback Logic**: Attempts alternative data sources if primary ones fail.
- **Excel Formatting**: Applies professional formatting to all Excel sheets.

---

## Getting Started

### Installation

1. **Clone the repository:**
   ```sh
   git clone https://github.com/yourusername/stock-analyzer.git
   cd stock-analyzer
   ```

2. **Install dependencies:**
   ```sh
   pip install -r requirements.txt
   ```

### Initial Dependencies

- All dependencies are listed in `requirements.txt`:
  - yfinance, pandas, requests, tqdm, xlsxwriter, beautifulsoup4, lxml, python-dateutil

### Setup & Usage

1. **Run the analysis for a ticker:**
   ```python
   import asyncio
   from stocks import StockAnalyzer

   async def analyze_stock():
       analyzer = StockAnalyzer("AAPL")  # Replace with your desired ticker
       await analyzer.fetch_all_data()

   asyncio.run(analyze_stock())
   ```

2. **Result:**
   - The Excel file will be saved in the `Datasets` directory, named after the ticker (e.g., `AAPL.xlsx`).

---

## Project Directory Structure

```
stock-analyzer/
│
├── stocks.py            # Main source code: StockAnalyzer class and all logic
├── requirements.txt     # Python dependencies
├── README.md            # Project documentation
├── Datasets/            # Output Excel files for each analyzed ticker
│   └── AAPL.xlsx        # Example output file for Apple Inc.
└── .git/                # Git version control directory
```

**Descriptions:**
- `stocks.py`: Main script containing all data fetching, processing, and Excel export logic.
- `requirements.txt`: List of required Python packages.
- `README.md`: Project documentation and usage instructions.
- `Datasets/`: Directory where all output Excel files are saved.
- `.git/`: Git metadata (not relevant for usage).

---

## Flowchart / Architecture Diagram

Below is a workflow of the Stock Analyzer, showing each Excel output sheet:

```
[User Input: Ticker]
        |
        v
[StockAnalyzer Class]
        |
        +-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+
        |                   |                   |                   |                   |                   |                   |                   |                   |
[Historical Data]   [ESG Scores]   [Company Summary]   [Statistics]   [Sustainability]   [Peers]   [Income Statement]   [Balance Sheet]   [Cash Flow]
        |                   |                   |                   |                   |                   |                   |                   |                   |
        +-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+
                                |
                                v
                    [Excel File Generation]
                                |
                                v
                    [Output: Datasets/<TICKER>.xlsx]
```

---

## Additional Notes

- **Rate Limiting**: Yahoo Finance may temporarily block requests if too many are made in a short period. The tool will report this in the Excel output.
- **Fallbacks**: If primary data sources fail, the tool attempts to use alternative sources or estimates.
- **Extensibility**: The code is modular and can be extended to support more data sources or output formats.

---

